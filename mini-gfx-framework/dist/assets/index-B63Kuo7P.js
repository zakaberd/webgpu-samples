(function(){const x=document.createElement("link").relList;if(x&&x.supports&&x.supports("modulepreload"))return;for(const G of document.querySelectorAll('link[rel="modulepreload"]'))S(G);new MutationObserver(G=>{for(const T of G)if(T.type==="childList")for(const q of T.addedNodes)q.tagName==="LINK"&&q.rel==="modulepreload"&&S(q)}).observe(document,{childList:!0,subtree:!0});function m(G){const T={};return G.integrity&&(T.integrity=G.integrity),G.referrerPolicy&&(T.referrerPolicy=G.referrerPolicy),G.crossOrigin==="use-credentials"?T.credentials="include":G.crossOrigin==="anonymous"?T.credentials="omit":T.credentials="same-origin",T}function S(G){if(G.ep)return;G.ep=!0;const T=m(G);fetch(G.href,T)}})();function ln(f,x){return class extends f{constructor(...m){super(...m),x(this)}}}const dn=ln(Array,f=>f.fill(0));let R=1e-6;function hn(f){function x(w=0,p=0){const g=new f(2);return w!==void 0&&(g[0]=w,p!==void 0&&(g[1]=p)),g}const m=x;function S(w,p,g){const t=g??new f(2);return t[0]=w,t[1]=p,t}function G(w,p){const g=p??new f(2);return g[0]=Math.ceil(w[0]),g[1]=Math.ceil(w[1]),g}function T(w,p){const g=p??new f(2);return g[0]=Math.floor(w[0]),g[1]=Math.floor(w[1]),g}function q(w,p){const g=p??new f(2);return g[0]=Math.round(w[0]),g[1]=Math.round(w[1]),g}function L(w,p=0,g=1,t){const a=t??new f(2);return a[0]=Math.min(g,Math.max(p,w[0])),a[1]=Math.min(g,Math.max(p,w[1])),a}function N(w,p,g){const t=g??new f(2);return t[0]=w[0]+p[0],t[1]=w[1]+p[1],t}function W(w,p,g,t){const a=t??new f(2);return a[0]=w[0]+p[0]*g,a[1]=w[1]+p[1]*g,a}function $(w,p){const g=w[0],t=w[1],a=p[0],s=p[1],c=Math.sqrt(g*g+t*t),e=Math.sqrt(a*a+s*s),r=c*e,h=r&&rt(w,p)/r;return Math.acos(h)}function Q(w,p,g){const t=g??new f(2);return t[0]=w[0]-p[0],t[1]=w[1]-p[1],t}const K=Q;function H(w,p){return Math.abs(w[0]-p[0])<R&&Math.abs(w[1]-p[1])<R}function C(w,p){return w[0]===p[0]&&w[1]===p[1]}function J(w,p,g,t){const a=t??new f(2);return a[0]=w[0]+g*(p[0]-w[0]),a[1]=w[1]+g*(p[1]-w[1]),a}function tt(w,p,g,t){const a=t??new f(2);return a[0]=w[0]+g[0]*(p[0]-w[0]),a[1]=w[1]+g[1]*(p[1]-w[1]),a}function k(w,p,g){const t=g??new f(2);return t[0]=Math.max(w[0],p[0]),t[1]=Math.max(w[1],p[1]),t}function b(w,p,g){const t=g??new f(2);return t[0]=Math.min(w[0],p[0]),t[1]=Math.min(w[1],p[1]),t}function it(w,p,g){const t=g??new f(2);return t[0]=w[0]*p,t[1]=w[1]*p,t}const lt=it;function Dt(w,p,g){const t=g??new f(2);return t[0]=w[0]/p,t[1]=w[1]/p,t}function dt(w,p){const g=p??new f(2);return g[0]=1/w[0],g[1]=1/w[1],g}const At=dt;function ht(w,p,g){const t=g??new f(3),a=w[0]*p[1]-w[1]*p[0];return t[0]=0,t[1]=0,t[2]=a,t}function rt(w,p){return w[0]*p[0]+w[1]*p[1]}function nt(w){const p=w[0],g=w[1];return Math.sqrt(p*p+g*g)}const Ft=nt;function at(w){const p=w[0],g=w[1];return p*p+g*g}const mt=at;function et(w,p){const g=w[0]-p[0],t=w[1]-p[1];return Math.sqrt(g*g+t*t)}const Z=et;function V(w,p){const g=w[0]-p[0],t=w[1]-p[1];return g*g+t*t}const O=V;function ut(w,p){const g=p??new f(2),t=w[0],a=w[1],s=Math.sqrt(t*t+a*a);return s>1e-5?(g[0]=t/s,g[1]=a/s):(g[0]=0,g[1]=0),g}function Gt(w,p){const g=p??new f(2);return g[0]=-w[0],g[1]=-w[1],g}function X(w,p){const g=p??new f(2);return g[0]=w[0],g[1]=w[1],g}const Rt=X;function Bt(w,p,g){const t=g??new f(2);return t[0]=w[0]*p[0],t[1]=w[1]*p[1],t}const Lt=Bt;function Tt(w,p,g){const t=g??new f(2);return t[0]=w[0]/p[0],t[1]=w[1]/p[1],t}const qt=Tt;function Vt(w=1,p){const g=p??new f(2),t=Math.random()*2*Math.PI;return g[0]=Math.cos(t)*w,g[1]=Math.sin(t)*w,g}function y(w){const p=w??new f(2);return p[0]=0,p[1]=0,p}function P(w,p,g){const t=g??new f(2),a=w[0],s=w[1];return t[0]=a*p[0]+s*p[4]+p[12],t[1]=a*p[1]+s*p[5]+p[13],t}function d(w,p,g){const t=g??new f(2),a=w[0],s=w[1];return t[0]=p[0]*a+p[4]*s+p[8],t[1]=p[1]*a+p[5]*s+p[9],t}function n(w,p,g,t){const a=t??new f(2),s=w[0]-p[0],c=w[1]-p[1],e=Math.sin(g),r=Math.cos(g);return a[0]=s*r-c*e+p[0],a[1]=s*e+c*r+p[1],a}function i(w,p,g){const t=g??new f(2);return ut(w,t),it(t,p,t)}function o(w,p,g){const t=g??new f(2);return nt(w)>p?i(w,p,t):X(w,t)}function u(w,p,g){const t=g??new f(2);return J(w,p,.5,t)}return{create:x,fromValues:m,set:S,ceil:G,floor:T,round:q,clamp:L,add:N,addScaled:W,angle:$,subtract:Q,sub:K,equalsApproximately:H,equals:C,lerp:J,lerpV:tt,max:k,min:b,mulScalar:it,scale:lt,divScalar:Dt,inverse:dt,invert:At,cross:ht,dot:rt,length:nt,len:Ft,lengthSq:at,lenSq:mt,distance:et,dist:Z,distanceSq:V,distSq:O,normalize:ut,negate:Gt,copy:X,clone:Rt,multiply:Bt,mul:Lt,divide:Tt,div:qt,random:Vt,zero:y,transformMat4:P,transformMat3:d,rotate:n,setLength:i,truncate:o,midpoint:u}}const nn=new Map;function fn(f){let x=nn.get(f);return x||(x=hn(f),nn.set(f,x)),x}function wn(f){function x(e,r,h){const l=new f(3);return e!==void 0&&(l[0]=e,r!==void 0&&(l[1]=r,h!==void 0&&(l[2]=h))),l}const m=x;function S(e,r,h,l){const M=l??new f(3);return M[0]=e,M[1]=r,M[2]=h,M}function G(e,r){const h=r??new f(3);return h[0]=Math.ceil(e[0]),h[1]=Math.ceil(e[1]),h[2]=Math.ceil(e[2]),h}function T(e,r){const h=r??new f(3);return h[0]=Math.floor(e[0]),h[1]=Math.floor(e[1]),h[2]=Math.floor(e[2]),h}function q(e,r){const h=r??new f(3);return h[0]=Math.round(e[0]),h[1]=Math.round(e[1]),h[2]=Math.round(e[2]),h}function L(e,r=0,h=1,l){const M=l??new f(3);return M[0]=Math.min(h,Math.max(r,e[0])),M[1]=Math.min(h,Math.max(r,e[1])),M[2]=Math.min(h,Math.max(r,e[2])),M}function N(e,r,h){const l=h??new f(3);return l[0]=e[0]+r[0],l[1]=e[1]+r[1],l[2]=e[2]+r[2],l}function W(e,r,h,l){const M=l??new f(3);return M[0]=e[0]+r[0]*h,M[1]=e[1]+r[1]*h,M[2]=e[2]+r[2]*h,M}function $(e,r){const h=e[0],l=e[1],M=e[2],D=r[0],A=r[1],B=r[2],z=Math.sqrt(h*h+l*l+M*M),v=Math.sqrt(D*D+A*A+B*B),F=z*v,I=F&&rt(e,r)/F;return Math.acos(I)}function Q(e,r,h){const l=h??new f(3);return l[0]=e[0]-r[0],l[1]=e[1]-r[1],l[2]=e[2]-r[2],l}const K=Q;function H(e,r){return Math.abs(e[0]-r[0])<R&&Math.abs(e[1]-r[1])<R&&Math.abs(e[2]-r[2])<R}function C(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]}function J(e,r,h,l){const M=l??new f(3);return M[0]=e[0]+h*(r[0]-e[0]),M[1]=e[1]+h*(r[1]-e[1]),M[2]=e[2]+h*(r[2]-e[2]),M}function tt(e,r,h,l){const M=l??new f(3);return M[0]=e[0]+h[0]*(r[0]-e[0]),M[1]=e[1]+h[1]*(r[1]-e[1]),M[2]=e[2]+h[2]*(r[2]-e[2]),M}function k(e,r,h){const l=h??new f(3);return l[0]=Math.max(e[0],r[0]),l[1]=Math.max(e[1],r[1]),l[2]=Math.max(e[2],r[2]),l}function b(e,r,h){const l=h??new f(3);return l[0]=Math.min(e[0],r[0]),l[1]=Math.min(e[1],r[1]),l[2]=Math.min(e[2],r[2]),l}function it(e,r,h){const l=h??new f(3);return l[0]=e[0]*r,l[1]=e[1]*r,l[2]=e[2]*r,l}const lt=it;function Dt(e,r,h){const l=h??new f(3);return l[0]=e[0]/r,l[1]=e[1]/r,l[2]=e[2]/r,l}function dt(e,r){const h=r??new f(3);return h[0]=1/e[0],h[1]=1/e[1],h[2]=1/e[2],h}const At=dt;function ht(e,r,h){const l=h??new f(3),M=e[2]*r[0]-e[0]*r[2],D=e[0]*r[1]-e[1]*r[0];return l[0]=e[1]*r[2]-e[2]*r[1],l[1]=M,l[2]=D,l}function rt(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function nt(e){const r=e[0],h=e[1],l=e[2];return Math.sqrt(r*r+h*h+l*l)}const Ft=nt;function at(e){const r=e[0],h=e[1],l=e[2];return r*r+h*h+l*l}const mt=at;function et(e,r){const h=e[0]-r[0],l=e[1]-r[1],M=e[2]-r[2];return Math.sqrt(h*h+l*l+M*M)}const Z=et;function V(e,r){const h=e[0]-r[0],l=e[1]-r[1],M=e[2]-r[2];return h*h+l*l+M*M}const O=V;function ut(e,r){const h=r??new f(3),l=e[0],M=e[1],D=e[2],A=Math.sqrt(l*l+M*M+D*D);return A>1e-5?(h[0]=l/A,h[1]=M/A,h[2]=D/A):(h[0]=0,h[1]=0,h[2]=0),h}function Gt(e,r){const h=r??new f(3);return h[0]=-e[0],h[1]=-e[1],h[2]=-e[2],h}function X(e,r){const h=r??new f(3);return h[0]=e[0],h[1]=e[1],h[2]=e[2],h}const Rt=X;function Bt(e,r,h){const l=h??new f(3);return l[0]=e[0]*r[0],l[1]=e[1]*r[1],l[2]=e[2]*r[2],l}const Lt=Bt;function Tt(e,r,h){const l=h??new f(3);return l[0]=e[0]/r[0],l[1]=e[1]/r[1],l[2]=e[2]/r[2],l}const qt=Tt;function Vt(e=1,r){const h=r??new f(3),l=Math.random()*2*Math.PI,M=Math.random()*2-1,D=Math.sqrt(1-M*M)*e;return h[0]=Math.cos(l)*D,h[1]=Math.sin(l)*D,h[2]=M*e,h}function y(e){const r=e??new f(3);return r[0]=0,r[1]=0,r[2]=0,r}function P(e,r,h){const l=h??new f(3),M=e[0],D=e[1],A=e[2],B=r[3]*M+r[7]*D+r[11]*A+r[15]||1;return l[0]=(r[0]*M+r[4]*D+r[8]*A+r[12])/B,l[1]=(r[1]*M+r[5]*D+r[9]*A+r[13])/B,l[2]=(r[2]*M+r[6]*D+r[10]*A+r[14])/B,l}function d(e,r,h){const l=h??new f(3),M=e[0],D=e[1],A=e[2];return l[0]=M*r[0]+D*r[4]+A*r[8],l[1]=M*r[1]+D*r[5]+A*r[9],l[2]=M*r[2]+D*r[6]+A*r[10],l}function n(e,r,h){const l=h??new f(3),M=e[0],D=e[1],A=e[2];return l[0]=M*r[0]+D*r[4]+A*r[8],l[1]=M*r[1]+D*r[5]+A*r[9],l[2]=M*r[2]+D*r[6]+A*r[10],l}function i(e,r,h){const l=h??new f(3),M=r[0],D=r[1],A=r[2],B=r[3]*2,z=e[0],v=e[1],F=e[2],I=D*F-A*v,E=A*z-M*F,U=M*v-D*z;return l[0]=z+I*B+(D*U-A*E)*2,l[1]=v+E*B+(A*I-M*U)*2,l[2]=F+U*B+(M*E-D*I)*2,l}function o(e,r){const h=r??new f(3);return h[0]=e[12],h[1]=e[13],h[2]=e[14],h}function u(e,r,h){const l=h??new f(3),M=r*4;return l[0]=e[M+0],l[1]=e[M+1],l[2]=e[M+2],l}function w(e,r){const h=r??new f(3),l=e[0],M=e[1],D=e[2],A=e[4],B=e[5],z=e[6],v=e[8],F=e[9],I=e[10];return h[0]=Math.sqrt(l*l+M*M+D*D),h[1]=Math.sqrt(A*A+B*B+z*z),h[2]=Math.sqrt(v*v+F*F+I*I),h}function p(e,r,h,l){const M=l??new f(3),D=[],A=[];return D[0]=e[0]-r[0],D[1]=e[1]-r[1],D[2]=e[2]-r[2],A[0]=D[0],A[1]=D[1]*Math.cos(h)-D[2]*Math.sin(h),A[2]=D[1]*Math.sin(h)+D[2]*Math.cos(h),M[0]=A[0]+r[0],M[1]=A[1]+r[1],M[2]=A[2]+r[2],M}function g(e,r,h,l){const M=l??new f(3),D=[],A=[];return D[0]=e[0]-r[0],D[1]=e[1]-r[1],D[2]=e[2]-r[2],A[0]=D[2]*Math.sin(h)+D[0]*Math.cos(h),A[1]=D[1],A[2]=D[2]*Math.cos(h)-D[0]*Math.sin(h),M[0]=A[0]+r[0],M[1]=A[1]+r[1],M[2]=A[2]+r[2],M}function t(e,r,h,l){const M=l??new f(3),D=[],A=[];return D[0]=e[0]-r[0],D[1]=e[1]-r[1],D[2]=e[2]-r[2],A[0]=D[0]*Math.cos(h)-D[1]*Math.sin(h),A[1]=D[0]*Math.sin(h)+D[1]*Math.cos(h),A[2]=D[2],M[0]=A[0]+r[0],M[1]=A[1]+r[1],M[2]=A[2]+r[2],M}function a(e,r,h){const l=h??new f(3);return ut(e,l),it(l,r,l)}function s(e,r,h){const l=h??new f(3);return nt(e)>r?a(e,r,l):X(e,l)}function c(e,r,h){const l=h??new f(3);return J(e,r,.5,l)}return{create:x,fromValues:m,set:S,ceil:G,floor:T,round:q,clamp:L,add:N,addScaled:W,angle:$,subtract:Q,sub:K,equalsApproximately:H,equals:C,lerp:J,lerpV:tt,max:k,min:b,mulScalar:it,scale:lt,divScalar:Dt,inverse:dt,invert:At,cross:ht,dot:rt,length:nt,len:Ft,lengthSq:at,lenSq:mt,distance:et,dist:Z,distanceSq:V,distSq:O,normalize:ut,negate:Gt,copy:X,clone:Rt,multiply:Bt,mul:Lt,divide:Tt,div:qt,random:Vt,zero:y,transformMat4:P,transformMat4Upper3x3:d,transformMat3:n,transformQuat:i,getTranslation:o,getAxis:u,getScaling:w,rotateX:p,rotateY:g,rotateZ:t,setLength:a,truncate:s,midpoint:c}}const en=new Map;function $t(f){let x=en.get(f);return x||(x=wn(f),en.set(f,x)),x}function pn(f){const x=fn(f),m=$t(f);function S(n,i,o,u,w,p,g,t,a){const s=new f(12);return s[3]=0,s[7]=0,s[11]=0,n!==void 0&&(s[0]=n,i!==void 0&&(s[1]=i,o!==void 0&&(s[2]=o,u!==void 0&&(s[4]=u,w!==void 0&&(s[5]=w,p!==void 0&&(s[6]=p,g!==void 0&&(s[8]=g,t!==void 0&&(s[9]=t,a!==void 0&&(s[10]=a))))))))),s}function G(n,i,o,u,w,p,g,t,a,s){const c=s??new f(12);return c[0]=n,c[1]=i,c[2]=o,c[3]=0,c[4]=u,c[5]=w,c[6]=p,c[7]=0,c[8]=g,c[9]=t,c[10]=a,c[11]=0,c}function T(n,i){const o=i??new f(12);return o[0]=n[0],o[1]=n[1],o[2]=n[2],o[3]=0,o[4]=n[4],o[5]=n[5],o[6]=n[6],o[7]=0,o[8]=n[8],o[9]=n[9],o[10]=n[10],o[11]=0,o}function q(n,i){const o=i??new f(12),u=n[0],w=n[1],p=n[2],g=n[3],t=u+u,a=w+w,s=p+p,c=u*t,e=w*t,r=w*a,h=p*t,l=p*a,M=p*s,D=g*t,A=g*a,B=g*s;return o[0]=1-r-M,o[1]=e+B,o[2]=h-A,o[3]=0,o[4]=e-B,o[5]=1-c-M,o[6]=l+D,o[7]=0,o[8]=h+A,o[9]=l-D,o[10]=1-c-r,o[11]=0,o}function L(n,i){const o=i??new f(12);return o[0]=-n[0],o[1]=-n[1],o[2]=-n[2],o[4]=-n[4],o[5]=-n[5],o[6]=-n[6],o[8]=-n[8],o[9]=-n[9],o[10]=-n[10],o}function N(n,i,o){const u=o??new f(12);return u[0]=n[0]*i,u[1]=n[1]*i,u[2]=n[2]*i,u[4]=n[4]*i,u[5]=n[5]*i,u[6]=n[6]*i,u[8]=n[8]*i,u[9]=n[9]*i,u[10]=n[10]*i,u}const W=N;function $(n,i,o){const u=o??new f(12);return u[0]=n[0]+i[0],u[1]=n[1]+i[1],u[2]=n[2]+i[2],u[4]=n[4]+i[4],u[5]=n[5]+i[5],u[6]=n[6]+i[6],u[8]=n[8]+i[8],u[9]=n[9]+i[9],u[10]=n[10]+i[10],u}function Q(n,i){const o=i??new f(12);return o[0]=n[0],o[1]=n[1],o[2]=n[2],o[4]=n[4],o[5]=n[5],o[6]=n[6],o[8]=n[8],o[9]=n[9],o[10]=n[10],o}const K=Q;function H(n,i){return Math.abs(n[0]-i[0])<R&&Math.abs(n[1]-i[1])<R&&Math.abs(n[2]-i[2])<R&&Math.abs(n[4]-i[4])<R&&Math.abs(n[5]-i[5])<R&&Math.abs(n[6]-i[6])<R&&Math.abs(n[8]-i[8])<R&&Math.abs(n[9]-i[9])<R&&Math.abs(n[10]-i[10])<R}function C(n,i){return n[0]===i[0]&&n[1]===i[1]&&n[2]===i[2]&&n[4]===i[4]&&n[5]===i[5]&&n[6]===i[6]&&n[8]===i[8]&&n[9]===i[9]&&n[10]===i[10]}function J(n){const i=n??new f(12);return i[0]=1,i[1]=0,i[2]=0,i[4]=0,i[5]=1,i[6]=0,i[8]=0,i[9]=0,i[10]=1,i}function tt(n,i){const o=i??new f(12);if(o===n){let r;return r=n[1],n[1]=n[4],n[4]=r,r=n[2],n[2]=n[8],n[8]=r,r=n[6],n[6]=n[9],n[9]=r,o}const u=n[0],w=n[1],p=n[2],g=n[4],t=n[5],a=n[6],s=n[8],c=n[9],e=n[10];return o[0]=u,o[1]=g,o[2]=s,o[4]=w,o[5]=t,o[6]=c,o[8]=p,o[9]=a,o[10]=e,o}function k(n,i){const o=i??new f(12),u=n[0],w=n[1],p=n[2],g=n[4],t=n[5],a=n[6],s=n[8],c=n[9],e=n[10],r=e*t-a*c,h=-e*g+a*s,l=c*g-t*s,M=1/(u*r+w*h+p*l);return o[0]=r*M,o[1]=(-e*w+p*c)*M,o[2]=(a*w-p*t)*M,o[4]=h*M,o[5]=(e*u-p*s)*M,o[6]=(-a*u+p*g)*M,o[8]=l*M,o[9]=(-c*u+w*s)*M,o[10]=(t*u-w*g)*M,o}function b(n){const i=n[0],o=n[1],u=n[2],w=n[4],p=n[5],g=n[6],t=n[8],a=n[9],s=n[10];return i*(p*s-a*g)-w*(o*s-a*u)+t*(o*g-p*u)}const it=k;function lt(n,i,o){const u=o??new f(12),w=n[0],p=n[1],g=n[2],t=n[4],a=n[5],s=n[6],c=n[8],e=n[9],r=n[10],h=i[0],l=i[1],M=i[2],D=i[4],A=i[5],B=i[6],z=i[8],v=i[9],F=i[10];return u[0]=w*h+t*l+c*M,u[1]=p*h+a*l+e*M,u[2]=g*h+s*l+r*M,u[4]=w*D+t*A+c*B,u[5]=p*D+a*A+e*B,u[6]=g*D+s*A+r*B,u[8]=w*z+t*v+c*F,u[9]=p*z+a*v+e*F,u[10]=g*z+s*v+r*F,u}const Dt=lt;function dt(n,i,o){const u=o??J();return n!==u&&(u[0]=n[0],u[1]=n[1],u[2]=n[2],u[4]=n[4],u[5]=n[5],u[6]=n[6]),u[8]=i[0],u[9]=i[1],u[10]=1,u}function At(n,i){const o=i??x.create();return o[0]=n[8],o[1]=n[9],o}function ht(n,i,o){const u=o??x.create(),w=i*4;return u[0]=n[w+0],u[1]=n[w+1],u}function rt(n,i,o,u){const w=u===n?n:Q(n,u),p=o*4;return w[p+0]=i[0],w[p+1]=i[1],w}function nt(n,i){const o=i??x.create(),u=n[0],w=n[1],p=n[4],g=n[5];return o[0]=Math.sqrt(u*u+w*w),o[1]=Math.sqrt(p*p+g*g),o}function Ft(n,i){const o=i??m.create(),u=n[0],w=n[1],p=n[2],g=n[4],t=n[5],a=n[6],s=n[8],c=n[9],e=n[10];return o[0]=Math.sqrt(u*u+w*w+p*p),o[1]=Math.sqrt(g*g+t*t+a*a),o[2]=Math.sqrt(s*s+c*c+e*e),o}function at(n,i){const o=i??new f(12);return o[0]=1,o[1]=0,o[2]=0,o[4]=0,o[5]=1,o[6]=0,o[8]=n[0],o[9]=n[1],o[10]=1,o}function mt(n,i,o){const u=o??new f(12),w=i[0],p=i[1],g=n[0],t=n[1],a=n[2],s=n[4],c=n[5],e=n[6],r=n[8],h=n[9],l=n[10];return n!==u&&(u[0]=g,u[1]=t,u[2]=a,u[4]=s,u[5]=c,u[6]=e),u[8]=g*w+s*p+r,u[9]=t*w+c*p+h,u[10]=a*w+e*p+l,u}function et(n,i){const o=i??new f(12),u=Math.cos(n),w=Math.sin(n);return o[0]=u,o[1]=w,o[2]=0,o[4]=-w,o[5]=u,o[6]=0,o[8]=0,o[9]=0,o[10]=1,o}function Z(n,i,o){const u=o??new f(12),w=n[0],p=n[1],g=n[2],t=n[4],a=n[5],s=n[6],c=Math.cos(i),e=Math.sin(i);return u[0]=c*w+e*t,u[1]=c*p+e*a,u[2]=c*g+e*s,u[4]=c*t-e*w,u[5]=c*a-e*p,u[6]=c*s-e*g,n!==u&&(u[8]=n[8],u[9]=n[9],u[10]=n[10]),u}function V(n,i){const o=i??new f(12),u=Math.cos(n),w=Math.sin(n);return o[0]=1,o[1]=0,o[2]=0,o[4]=0,o[5]=u,o[6]=w,o[8]=0,o[9]=-w,o[10]=u,o}function O(n,i,o){const u=o??new f(12),w=n[4],p=n[5],g=n[6],t=n[8],a=n[9],s=n[10],c=Math.cos(i),e=Math.sin(i);return u[4]=c*w+e*t,u[5]=c*p+e*a,u[6]=c*g+e*s,u[8]=c*t-e*w,u[9]=c*a-e*p,u[10]=c*s-e*g,n!==u&&(u[0]=n[0],u[1]=n[1],u[2]=n[2]),u}function ut(n,i){const o=i??new f(12),u=Math.cos(n),w=Math.sin(n);return o[0]=u,o[1]=0,o[2]=-w,o[4]=0,o[5]=1,o[6]=0,o[8]=w,o[9]=0,o[10]=u,o}function Gt(n,i,o){const u=o??new f(12),w=n[0],p=n[1],g=n[2],t=n[8],a=n[9],s=n[10],c=Math.cos(i),e=Math.sin(i);return u[0]=c*w-e*t,u[1]=c*p-e*a,u[2]=c*g-e*s,u[8]=c*t+e*w,u[9]=c*a+e*p,u[10]=c*s+e*g,n!==u&&(u[4]=n[4],u[5]=n[5],u[6]=n[6]),u}const X=et,Rt=Z;function Bt(n,i){const o=i??new f(12);return o[0]=n[0],o[1]=0,o[2]=0,o[4]=0,o[5]=n[1],o[6]=0,o[8]=0,o[9]=0,o[10]=1,o}function Lt(n,i,o){const u=o??new f(12),w=i[0],p=i[1];return u[0]=w*n[0],u[1]=w*n[1],u[2]=w*n[2],u[4]=p*n[4],u[5]=p*n[5],u[6]=p*n[6],n!==u&&(u[8]=n[8],u[9]=n[9],u[10]=n[10]),u}function Tt(n,i){const o=i??new f(12);return o[0]=n[0],o[1]=0,o[2]=0,o[4]=0,o[5]=n[1],o[6]=0,o[8]=0,o[9]=0,o[10]=n[2],o}function qt(n,i,o){const u=o??new f(12),w=i[0],p=i[1],g=i[2];return u[0]=w*n[0],u[1]=w*n[1],u[2]=w*n[2],u[4]=p*n[4],u[5]=p*n[5],u[6]=p*n[6],u[8]=g*n[8],u[9]=g*n[9],u[10]=g*n[10],u}function Vt(n,i){const o=i??new f(12);return o[0]=n,o[1]=0,o[2]=0,o[4]=0,o[5]=n,o[6]=0,o[8]=0,o[9]=0,o[10]=1,o}function y(n,i,o){const u=o??new f(12);return u[0]=i*n[0],u[1]=i*n[1],u[2]=i*n[2],u[4]=i*n[4],u[5]=i*n[5],u[6]=i*n[6],n!==u&&(u[8]=n[8],u[9]=n[9],u[10]=n[10]),u}function P(n,i){const o=i??new f(12);return o[0]=n,o[1]=0,o[2]=0,o[4]=0,o[5]=n,o[6]=0,o[8]=0,o[9]=0,o[10]=n,o}function d(n,i,o){const u=o??new f(12);return u[0]=i*n[0],u[1]=i*n[1],u[2]=i*n[2],u[4]=i*n[4],u[5]=i*n[5],u[6]=i*n[6],u[8]=i*n[8],u[9]=i*n[9],u[10]=i*n[10],u}return{add:$,clone:K,copy:Q,create:S,determinant:b,equals:C,equalsApproximately:H,fromMat4:T,fromQuat:q,get3DScaling:Ft,getAxis:ht,getScaling:nt,getTranslation:At,identity:J,inverse:k,invert:it,mul:Dt,mulScalar:W,multiply:lt,multiplyScalar:N,negate:L,rotate:Z,rotateX:O,rotateY:Gt,rotateZ:Rt,rotation:et,rotationX:V,rotationY:ut,rotationZ:X,scale:Lt,scale3D:qt,scaling:Bt,scaling3D:Tt,set:G,setAxis:rt,setTranslation:dt,translate:mt,translation:at,transpose:tt,uniformScale:y,uniformScale3D:d,uniformScaling:Vt,uniformScaling3D:P}}const sn=new Map;function gn(f){let x=sn.get(f);return x||(x=pn(f),sn.set(f,x)),x}function xn(f){const x=$t(f);function m(t,a,s,c,e,r,h,l,M,D,A,B,z,v,F,I){const E=new f(16);return t!==void 0&&(E[0]=t,a!==void 0&&(E[1]=a,s!==void 0&&(E[2]=s,c!==void 0&&(E[3]=c,e!==void 0&&(E[4]=e,r!==void 0&&(E[5]=r,h!==void 0&&(E[6]=h,l!==void 0&&(E[7]=l,M!==void 0&&(E[8]=M,D!==void 0&&(E[9]=D,A!==void 0&&(E[10]=A,B!==void 0&&(E[11]=B,z!==void 0&&(E[12]=z,v!==void 0&&(E[13]=v,F!==void 0&&(E[14]=F,I!==void 0&&(E[15]=I)))))))))))))))),E}function S(t,a,s,c,e,r,h,l,M,D,A,B,z,v,F,I,E){const U=E??new f(16);return U[0]=t,U[1]=a,U[2]=s,U[3]=c,U[4]=e,U[5]=r,U[6]=h,U[7]=l,U[8]=M,U[9]=D,U[10]=A,U[11]=B,U[12]=z,U[13]=v,U[14]=F,U[15]=I,U}function G(t,a){const s=a??new f(16);return s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=0,s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=0,s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function T(t,a){const s=a??new f(16),c=t[0],e=t[1],r=t[2],h=t[3],l=c+c,M=e+e,D=r+r,A=c*l,B=e*l,z=e*M,v=r*l,F=r*M,I=r*D,E=h*l,U=h*M,j=h*D;return s[0]=1-z-I,s[1]=B+j,s[2]=v-U,s[3]=0,s[4]=B-j,s[5]=1-A-I,s[6]=F+E,s[7]=0,s[8]=v+U,s[9]=F-E,s[10]=1-A-z,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function q(t,a){const s=a??new f(16);return s[0]=-t[0],s[1]=-t[1],s[2]=-t[2],s[3]=-t[3],s[4]=-t[4],s[5]=-t[5],s[6]=-t[6],s[7]=-t[7],s[8]=-t[8],s[9]=-t[9],s[10]=-t[10],s[11]=-t[11],s[12]=-t[12],s[13]=-t[13],s[14]=-t[14],s[15]=-t[15],s}function L(t,a,s){const c=s??new f(16);return c[0]=t[0]+a[0],c[1]=t[1]+a[1],c[2]=t[2]+a[2],c[3]=t[3]+a[3],c[4]=t[4]+a[4],c[5]=t[5]+a[5],c[6]=t[6]+a[6],c[7]=t[7]+a[7],c[8]=t[8]+a[8],c[9]=t[9]+a[9],c[10]=t[10]+a[10],c[11]=t[11]+a[11],c[12]=t[12]+a[12],c[13]=t[13]+a[13],c[14]=t[14]+a[14],c[15]=t[15]+a[15],c}function N(t,a,s){const c=s??new f(16);return c[0]=t[0]*a,c[1]=t[1]*a,c[2]=t[2]*a,c[3]=t[3]*a,c[4]=t[4]*a,c[5]=t[5]*a,c[6]=t[6]*a,c[7]=t[7]*a,c[8]=t[8]*a,c[9]=t[9]*a,c[10]=t[10]*a,c[11]=t[11]*a,c[12]=t[12]*a,c[13]=t[13]*a,c[14]=t[14]*a,c[15]=t[15]*a,c}const W=N;function $(t,a){const s=a??new f(16);return s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=t[7],s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=t[11],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s}const Q=$;function K(t,a){return Math.abs(t[0]-a[0])<R&&Math.abs(t[1]-a[1])<R&&Math.abs(t[2]-a[2])<R&&Math.abs(t[3]-a[3])<R&&Math.abs(t[4]-a[4])<R&&Math.abs(t[5]-a[5])<R&&Math.abs(t[6]-a[6])<R&&Math.abs(t[7]-a[7])<R&&Math.abs(t[8]-a[8])<R&&Math.abs(t[9]-a[9])<R&&Math.abs(t[10]-a[10])<R&&Math.abs(t[11]-a[11])<R&&Math.abs(t[12]-a[12])<R&&Math.abs(t[13]-a[13])<R&&Math.abs(t[14]-a[14])<R&&Math.abs(t[15]-a[15])<R}function H(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]&&t[9]===a[9]&&t[10]===a[10]&&t[11]===a[11]&&t[12]===a[12]&&t[13]===a[13]&&t[14]===a[14]&&t[15]===a[15]}function C(t){const a=t??new f(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function J(t,a){const s=a??new f(16);if(s===t){let Y;return Y=t[1],t[1]=t[4],t[4]=Y,Y=t[2],t[2]=t[8],t[8]=Y,Y=t[3],t[3]=t[12],t[12]=Y,Y=t[6],t[6]=t[9],t[9]=Y,Y=t[7],t[7]=t[13],t[13]=Y,Y=t[11],t[11]=t[14],t[14]=Y,s}const c=t[0],e=t[1],r=t[2],h=t[3],l=t[4],M=t[5],D=t[6],A=t[7],B=t[8],z=t[9],v=t[10],F=t[11],I=t[12],E=t[13],U=t[14],j=t[15];return s[0]=c,s[1]=l,s[2]=B,s[3]=I,s[4]=e,s[5]=M,s[6]=z,s[7]=E,s[8]=r,s[9]=D,s[10]=v,s[11]=U,s[12]=h,s[13]=A,s[14]=F,s[15]=j,s}function tt(t,a){const s=a??new f(16),c=t[0],e=t[1],r=t[2],h=t[3],l=t[4],M=t[5],D=t[6],A=t[7],B=t[8],z=t[9],v=t[10],F=t[11],I=t[12],E=t[13],U=t[14],j=t[15],Y=v*j,st=U*F,ot=D*j,ct=U*A,ft=D*F,wt=v*A,pt=r*j,gt=U*h,xt=r*F,yt=v*h,Pt=r*A,St=D*h,zt=B*E,vt=I*z,Et=l*E,Ut=I*M,It=l*z,Zt=B*M,Ot=c*E,Nt=I*e,Xt=c*z,Yt=B*e,Ht=c*M,Qt=l*e,kt=Y*M+ct*z+ft*E-(st*M+ot*z+wt*E),Jt=st*e+pt*z+yt*E-(Y*e+gt*z+xt*E),Ct=ot*e+gt*M+Pt*E-(ct*e+pt*M+St*E),tn=wt*e+xt*M+St*z-(ft*e+yt*M+Pt*z),Mt=1/(c*kt+l*Jt+B*Ct+I*tn);return s[0]=Mt*kt,s[1]=Mt*Jt,s[2]=Mt*Ct,s[3]=Mt*tn,s[4]=Mt*(st*l+ot*B+wt*I-(Y*l+ct*B+ft*I)),s[5]=Mt*(Y*c+gt*B+xt*I-(st*c+pt*B+yt*I)),s[6]=Mt*(ct*c+pt*l+St*I-(ot*c+gt*l+Pt*I)),s[7]=Mt*(ft*c+yt*l+Pt*B-(wt*c+xt*l+St*B)),s[8]=Mt*(zt*A+Ut*F+It*j-(vt*A+Et*F+Zt*j)),s[9]=Mt*(vt*h+Ot*F+Yt*j-(zt*h+Nt*F+Xt*j)),s[10]=Mt*(Et*h+Nt*A+Ht*j-(Ut*h+Ot*A+Qt*j)),s[11]=Mt*(Zt*h+Xt*A+Qt*F-(It*h+Yt*A+Ht*F)),s[12]=Mt*(Et*v+Zt*U+vt*D-(It*U+zt*D+Ut*v)),s[13]=Mt*(Xt*U+zt*r+Nt*v-(Ot*v+Yt*U+vt*r)),s[14]=Mt*(Ot*D+Qt*U+Ut*r-(Ht*U+Et*r+Nt*D)),s[15]=Mt*(Ht*v+It*r+Yt*D-(Xt*D+Qt*v+Zt*r)),s}function k(t){const a=t[0],s=t[1],c=t[2],e=t[3],r=t[4],h=t[5],l=t[6],M=t[7],D=t[8],A=t[9],B=t[10],z=t[11],v=t[12],F=t[13],I=t[14],E=t[15],U=B*E,j=I*z,Y=l*E,st=I*M,ot=l*z,ct=B*M,ft=c*E,wt=I*e,pt=c*z,gt=B*e,xt=c*M,yt=l*e,Pt=U*h+st*A+ot*F-(j*h+Y*A+ct*F),St=j*s+ft*A+gt*F-(U*s+wt*A+pt*F),zt=Y*s+wt*h+xt*F-(st*s+ft*h+yt*F),vt=ct*s+pt*h+yt*A-(ot*s+gt*h+xt*A);return a*Pt+r*St+D*zt+v*vt}const b=tt;function it(t,a,s){const c=s??new f(16),e=t[0],r=t[1],h=t[2],l=t[3],M=t[4],D=t[5],A=t[6],B=t[7],z=t[8],v=t[9],F=t[10],I=t[11],E=t[12],U=t[13],j=t[14],Y=t[15],st=a[0],ot=a[1],ct=a[2],ft=a[3],wt=a[4],pt=a[5],gt=a[6],xt=a[7],yt=a[8],Pt=a[9],St=a[10],zt=a[11],vt=a[12],Et=a[13],Ut=a[14],It=a[15];return c[0]=e*st+M*ot+z*ct+E*ft,c[1]=r*st+D*ot+v*ct+U*ft,c[2]=h*st+A*ot+F*ct+j*ft,c[3]=l*st+B*ot+I*ct+Y*ft,c[4]=e*wt+M*pt+z*gt+E*xt,c[5]=r*wt+D*pt+v*gt+U*xt,c[6]=h*wt+A*pt+F*gt+j*xt,c[7]=l*wt+B*pt+I*gt+Y*xt,c[8]=e*yt+M*Pt+z*St+E*zt,c[9]=r*yt+D*Pt+v*St+U*zt,c[10]=h*yt+A*Pt+F*St+j*zt,c[11]=l*yt+B*Pt+I*St+Y*zt,c[12]=e*vt+M*Et+z*Ut+E*It,c[13]=r*vt+D*Et+v*Ut+U*It,c[14]=h*vt+A*Et+F*Ut+j*It,c[15]=l*vt+B*Et+I*Ut+Y*It,c}const lt=it;function Dt(t,a,s){const c=s??C();return t!==c&&(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7],c[8]=t[8],c[9]=t[9],c[10]=t[10],c[11]=t[11]),c[12]=a[0],c[13]=a[1],c[14]=a[2],c[15]=1,c}function dt(t,a){const s=a??x.create();return s[0]=t[12],s[1]=t[13],s[2]=t[14],s}function At(t,a,s){const c=s??x.create(),e=a*4;return c[0]=t[e+0],c[1]=t[e+1],c[2]=t[e+2],c}function ht(t,a,s,c){const e=c===t?c:$(t,c),r=s*4;return e[r+0]=a[0],e[r+1]=a[1],e[r+2]=a[2],e}function rt(t,a){const s=a??x.create(),c=t[0],e=t[1],r=t[2],h=t[4],l=t[5],M=t[6],D=t[8],A=t[9],B=t[10];return s[0]=Math.sqrt(c*c+e*e+r*r),s[1]=Math.sqrt(h*h+l*l+M*M),s[2]=Math.sqrt(D*D+A*A+B*B),s}function nt(t,a,s,c,e){const r=e??new f(16),h=Math.tan(Math.PI*.5-.5*t);if(r[0]=h/a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=h,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,Number.isFinite(c)){const l=1/(s-c);r[10]=c*l,r[14]=c*s*l}else r[10]=-1,r[14]=-s;return r}function Ft(t,a,s,c=1/0,e){const r=e??new f(16),h=1/Math.tan(t*.5);if(r[0]=h/a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=h,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,c===1/0)r[10]=0,r[14]=s;else{const l=1/(c-s);r[10]=s*l,r[14]=c*s*l}return r}function at(t,a,s,c,e,r,h){const l=h??new f(16);return l[0]=2/(a-t),l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=2/(c-s),l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1/(e-r),l[11]=0,l[12]=(a+t)/(t-a),l[13]=(c+s)/(s-c),l[14]=e/(e-r),l[15]=1,l}function mt(t,a,s,c,e,r,h){const l=h??new f(16),M=a-t,D=c-s,A=e-r;return l[0]=2*e/M,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=2*e/D,l[6]=0,l[7]=0,l[8]=(t+a)/M,l[9]=(c+s)/D,l[10]=r/A,l[11]=-1,l[12]=0,l[13]=0,l[14]=e*r/A,l[15]=0,l}function et(t,a,s,c,e,r=1/0,h){const l=h??new f(16),M=a-t,D=c-s;if(l[0]=2*e/M,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=2*e/D,l[6]=0,l[7]=0,l[8]=(t+a)/M,l[9]=(c+s)/D,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,r===1/0)l[10]=0,l[14]=e;else{const A=1/(r-e);l[10]=e*A,l[14]=r*e*A}return l}const Z=x.create(),V=x.create(),O=x.create();function ut(t,a,s,c){const e=c??new f(16);return x.normalize(x.subtract(a,t,O),O),x.normalize(x.cross(s,O,Z),Z),x.normalize(x.cross(O,Z,V),V),e[0]=Z[0],e[1]=Z[1],e[2]=Z[2],e[3]=0,e[4]=V[0],e[5]=V[1],e[6]=V[2],e[7]=0,e[8]=O[0],e[9]=O[1],e[10]=O[2],e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Gt(t,a,s,c){const e=c??new f(16);return x.normalize(x.subtract(t,a,O),O),x.normalize(x.cross(s,O,Z),Z),x.normalize(x.cross(O,Z,V),V),e[0]=Z[0],e[1]=Z[1],e[2]=Z[2],e[3]=0,e[4]=V[0],e[5]=V[1],e[6]=V[2],e[7]=0,e[8]=O[0],e[9]=O[1],e[10]=O[2],e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function X(t,a,s,c){const e=c??new f(16);return x.normalize(x.subtract(t,a,O),O),x.normalize(x.cross(s,O,Z),Z),x.normalize(x.cross(O,Z,V),V),e[0]=Z[0],e[1]=V[0],e[2]=O[0],e[3]=0,e[4]=Z[1],e[5]=V[1],e[6]=O[1],e[7]=0,e[8]=Z[2],e[9]=V[2],e[10]=O[2],e[11]=0,e[12]=-(Z[0]*t[0]+Z[1]*t[1]+Z[2]*t[2]),e[13]=-(V[0]*t[0]+V[1]*t[1]+V[2]*t[2]),e[14]=-(O[0]*t[0]+O[1]*t[1]+O[2]*t[2]),e[15]=1,e}function Rt(t,a){const s=a??new f(16);return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=t[0],s[13]=t[1],s[14]=t[2],s[15]=1,s}function Bt(t,a,s){const c=s??new f(16),e=a[0],r=a[1],h=a[2],l=t[0],M=t[1],D=t[2],A=t[3],B=t[4],z=t[5],v=t[6],F=t[7],I=t[8],E=t[9],U=t[10],j=t[11],Y=t[12],st=t[13],ot=t[14],ct=t[15];return t!==c&&(c[0]=l,c[1]=M,c[2]=D,c[3]=A,c[4]=B,c[5]=z,c[6]=v,c[7]=F,c[8]=I,c[9]=E,c[10]=U,c[11]=j),c[12]=l*e+B*r+I*h+Y,c[13]=M*e+z*r+E*h+st,c[14]=D*e+v*r+U*h+ot,c[15]=A*e+F*r+j*h+ct,c}function Lt(t,a){const s=a??new f(16),c=Math.cos(t),e=Math.sin(t);return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=c,s[6]=e,s[7]=0,s[8]=0,s[9]=-e,s[10]=c,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Tt(t,a,s){const c=s??new f(16),e=t[4],r=t[5],h=t[6],l=t[7],M=t[8],D=t[9],A=t[10],B=t[11],z=Math.cos(a),v=Math.sin(a);return c[4]=z*e+v*M,c[5]=z*r+v*D,c[6]=z*h+v*A,c[7]=z*l+v*B,c[8]=z*M-v*e,c[9]=z*D-v*r,c[10]=z*A-v*h,c[11]=z*B-v*l,t!==c&&(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[12]=t[12],c[13]=t[13],c[14]=t[14],c[15]=t[15]),c}function qt(t,a){const s=a??new f(16),c=Math.cos(t),e=Math.sin(t);return s[0]=c,s[1]=0,s[2]=-e,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=e,s[9]=0,s[10]=c,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Vt(t,a,s){const c=s??new f(16),e=t[0],r=t[1],h=t[2],l=t[3],M=t[8],D=t[9],A=t[10],B=t[11],z=Math.cos(a),v=Math.sin(a);return c[0]=z*e-v*M,c[1]=z*r-v*D,c[2]=z*h-v*A,c[3]=z*l-v*B,c[8]=z*M+v*e,c[9]=z*D+v*r,c[10]=z*A+v*h,c[11]=z*B+v*l,t!==c&&(c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7],c[12]=t[12],c[13]=t[13],c[14]=t[14],c[15]=t[15]),c}function y(t,a){const s=a??new f(16),c=Math.cos(t),e=Math.sin(t);return s[0]=c,s[1]=e,s[2]=0,s[3]=0,s[4]=-e,s[5]=c,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function P(t,a,s){const c=s??new f(16),e=t[0],r=t[1],h=t[2],l=t[3],M=t[4],D=t[5],A=t[6],B=t[7],z=Math.cos(a),v=Math.sin(a);return c[0]=z*e+v*M,c[1]=z*r+v*D,c[2]=z*h+v*A,c[3]=z*l+v*B,c[4]=z*M-v*e,c[5]=z*D-v*r,c[6]=z*A-v*h,c[7]=z*B-v*l,t!==c&&(c[8]=t[8],c[9]=t[9],c[10]=t[10],c[11]=t[11],c[12]=t[12],c[13]=t[13],c[14]=t[14],c[15]=t[15]),c}function d(t,a,s){const c=s??new f(16);let e=t[0],r=t[1],h=t[2];const l=Math.sqrt(e*e+r*r+h*h);e/=l,r/=l,h/=l;const M=e*e,D=r*r,A=h*h,B=Math.cos(a),z=Math.sin(a),v=1-B;return c[0]=M+(1-M)*B,c[1]=e*r*v+h*z,c[2]=e*h*v-r*z,c[3]=0,c[4]=e*r*v-h*z,c[5]=D+(1-D)*B,c[6]=r*h*v+e*z,c[7]=0,c[8]=e*h*v+r*z,c[9]=r*h*v-e*z,c[10]=A+(1-A)*B,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}const n=d;function i(t,a,s,c){const e=c??new f(16);let r=a[0],h=a[1],l=a[2];const M=Math.sqrt(r*r+h*h+l*l);r/=M,h/=M,l/=M;const D=r*r,A=h*h,B=l*l,z=Math.cos(s),v=Math.sin(s),F=1-z,I=D+(1-D)*z,E=r*h*F+l*v,U=r*l*F-h*v,j=r*h*F-l*v,Y=A+(1-A)*z,st=h*l*F+r*v,ot=r*l*F+h*v,ct=h*l*F-r*v,ft=B+(1-B)*z,wt=t[0],pt=t[1],gt=t[2],xt=t[3],yt=t[4],Pt=t[5],St=t[6],zt=t[7],vt=t[8],Et=t[9],Ut=t[10],It=t[11];return e[0]=I*wt+E*yt+U*vt,e[1]=I*pt+E*Pt+U*Et,e[2]=I*gt+E*St+U*Ut,e[3]=I*xt+E*zt+U*It,e[4]=j*wt+Y*yt+st*vt,e[5]=j*pt+Y*Pt+st*Et,e[6]=j*gt+Y*St+st*Ut,e[7]=j*xt+Y*zt+st*It,e[8]=ot*wt+ct*yt+ft*vt,e[9]=ot*pt+ct*Pt+ft*Et,e[10]=ot*gt+ct*St+ft*Ut,e[11]=ot*xt+ct*zt+ft*It,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e}const o=i;function u(t,a){const s=a??new f(16);return s[0]=t[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=t[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=t[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function w(t,a,s){const c=s??new f(16),e=a[0],r=a[1],h=a[2];return c[0]=e*t[0],c[1]=e*t[1],c[2]=e*t[2],c[3]=e*t[3],c[4]=r*t[4],c[5]=r*t[5],c[6]=r*t[6],c[7]=r*t[7],c[8]=h*t[8],c[9]=h*t[9],c[10]=h*t[10],c[11]=h*t[11],t!==c&&(c[12]=t[12],c[13]=t[13],c[14]=t[14],c[15]=t[15]),c}function p(t,a){const s=a??new f(16);return s[0]=t,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=t,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=t,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function g(t,a,s){const c=s??new f(16);return c[0]=a*t[0],c[1]=a*t[1],c[2]=a*t[2],c[3]=a*t[3],c[4]=a*t[4],c[5]=a*t[5],c[6]=a*t[6],c[7]=a*t[7],c[8]=a*t[8],c[9]=a*t[9],c[10]=a*t[10],c[11]=a*t[11],t!==c&&(c[12]=t[12],c[13]=t[13],c[14]=t[14],c[15]=t[15]),c}return{add:L,aim:ut,axisRotate:i,axisRotation:d,cameraAim:Gt,clone:Q,copy:$,create:m,determinant:k,equals:H,equalsApproximately:K,fromMat3:G,fromQuat:T,frustum:mt,frustumReverseZ:et,getAxis:At,getScaling:rt,getTranslation:dt,identity:C,inverse:tt,invert:b,lookAt:X,mul:lt,mulScalar:W,multiply:it,multiplyScalar:N,negate:q,ortho:at,perspective:nt,perspectiveReverseZ:Ft,rotate:o,rotateX:Tt,rotateY:Vt,rotateZ:P,rotation:n,rotationX:Lt,rotationY:qt,rotationZ:y,scale:w,scaling:u,set:S,setAxis:ht,setTranslation:Dt,translate:Bt,translation:Rt,transpose:J,uniformScale:g,uniformScaling:p}}const on=new Map;function yn(f){let x=on.get(f);return x||(x=xn(f),on.set(f,x)),x}function Mn(f){const x=$t(f);function m(y,P,d,n){const i=new f(4);return y!==void 0&&(i[0]=y,P!==void 0&&(i[1]=P,d!==void 0&&(i[2]=d,n!==void 0&&(i[3]=n)))),i}const S=m;function G(y,P,d,n,i){const o=i??new f(4);return o[0]=y,o[1]=P,o[2]=d,o[3]=n,o}function T(y,P,d){const n=d??new f(4),i=P*.5,o=Math.sin(i);return n[0]=o*y[0],n[1]=o*y[1],n[2]=o*y[2],n[3]=Math.cos(i),n}function q(y,P){const d=P??x.create(3),n=Math.acos(y[3])*2,i=Math.sin(n*.5);return i>R?(d[0]=y[0]/i,d[1]=y[1]/i,d[2]=y[2]/i):(d[0]=1,d[1]=0,d[2]=0),{angle:n,axis:d}}function L(y,P){const d=nt(y,P);return Math.acos(2*d*d-1)}function N(y,P,d){const n=d??new f(4),i=y[0],o=y[1],u=y[2],w=y[3],p=P[0],g=P[1],t=P[2],a=P[3];return n[0]=i*a+w*p+o*t-u*g,n[1]=o*a+w*g+u*p-i*t,n[2]=u*a+w*t+i*g-o*p,n[3]=w*a-i*p-o*g-u*t,n}const W=N;function $(y,P,d){const n=d??new f(4),i=P*.5,o=y[0],u=y[1],w=y[2],p=y[3],g=Math.sin(i),t=Math.cos(i);return n[0]=o*t+p*g,n[1]=u*t+w*g,n[2]=w*t-u*g,n[3]=p*t-o*g,n}function Q(y,P,d){const n=d??new f(4),i=P*.5,o=y[0],u=y[1],w=y[2],p=y[3],g=Math.sin(i),t=Math.cos(i);return n[0]=o*t-w*g,n[1]=u*t+p*g,n[2]=w*t+o*g,n[3]=p*t-u*g,n}function K(y,P,d){const n=d??new f(4),i=P*.5,o=y[0],u=y[1],w=y[2],p=y[3],g=Math.sin(i),t=Math.cos(i);return n[0]=o*t+u*g,n[1]=u*t-o*g,n[2]=w*t+p*g,n[3]=p*t-w*g,n}function H(y,P,d,n){const i=n??new f(4),o=y[0],u=y[1],w=y[2],p=y[3];let g=P[0],t=P[1],a=P[2],s=P[3],c=o*g+u*t+w*a+p*s;c<0&&(c=-c,g=-g,t=-t,a=-a,s=-s);let e,r;if(1-c>R){const h=Math.acos(c),l=Math.sin(h);e=Math.sin((1-d)*h)/l,r=Math.sin(d*h)/l}else e=1-d,r=d;return i[0]=e*o+r*g,i[1]=e*u+r*t,i[2]=e*w+r*a,i[3]=e*p+r*s,i}function C(y,P){const d=P??new f(4),n=y[0],i=y[1],o=y[2],u=y[3],w=n*n+i*i+o*o+u*u,p=w?1/w:0;return d[0]=-n*p,d[1]=-i*p,d[2]=-o*p,d[3]=u*p,d}function J(y,P){const d=P??new f(4);return d[0]=-y[0],d[1]=-y[1],d[2]=-y[2],d[3]=y[3],d}function tt(y,P){const d=P??new f(4),n=y[0]+y[5]+y[10];if(n>0){const i=Math.sqrt(n+1);d[3]=.5*i;const o=.5/i;d[0]=(y[6]-y[9])*o,d[1]=(y[8]-y[2])*o,d[2]=(y[1]-y[4])*o}else{let i=0;y[5]>y[0]&&(i=1),y[10]>y[i*4+i]&&(i=2);const o=(i+1)%3,u=(i+2)%3,w=Math.sqrt(y[i*4+i]-y[o*4+o]-y[u*4+u]+1);d[i]=.5*w;const p=.5/w;d[3]=(y[o*4+u]-y[u*4+o])*p,d[o]=(y[o*4+i]+y[i*4+o])*p,d[u]=(y[u*4+i]+y[i*4+u])*p}return d}function k(y,P,d,n,i){const o=i??new f(4),u=y*.5,w=P*.5,p=d*.5,g=Math.sin(u),t=Math.cos(u),a=Math.sin(w),s=Math.cos(w),c=Math.sin(p),e=Math.cos(p);switch(n){case"xyz":o[0]=g*s*e+t*a*c,o[1]=t*a*e-g*s*c,o[2]=t*s*c+g*a*e,o[3]=t*s*e-g*a*c;break;case"xzy":o[0]=g*s*e-t*a*c,o[1]=t*a*e-g*s*c,o[2]=t*s*c+g*a*e,o[3]=t*s*e+g*a*c;break;case"yxz":o[0]=g*s*e+t*a*c,o[1]=t*a*e-g*s*c,o[2]=t*s*c-g*a*e,o[3]=t*s*e+g*a*c;break;case"yzx":o[0]=g*s*e+t*a*c,o[1]=t*a*e+g*s*c,o[2]=t*s*c-g*a*e,o[3]=t*s*e-g*a*c;break;case"zxy":o[0]=g*s*e-t*a*c,o[1]=t*a*e+g*s*c,o[2]=t*s*c+g*a*e,o[3]=t*s*e-g*a*c;break;case"zyx":o[0]=g*s*e-t*a*c,o[1]=t*a*e+g*s*c,o[2]=t*s*c-g*a*e,o[3]=t*s*e+g*a*c;break;default:throw new Error(`Unknown rotation order: ${n}`)}return o}function b(y,P){const d=P??new f(4);return d[0]=y[0],d[1]=y[1],d[2]=y[2],d[3]=y[3],d}const it=b;function lt(y,P,d){const n=d??new f(4);return n[0]=y[0]+P[0],n[1]=y[1]+P[1],n[2]=y[2]+P[2],n[3]=y[3]+P[3],n}function Dt(y,P,d){const n=d??new f(4);return n[0]=y[0]-P[0],n[1]=y[1]-P[1],n[2]=y[2]-P[2],n[3]=y[3]-P[3],n}const dt=Dt;function At(y,P,d){const n=d??new f(4);return n[0]=y[0]*P,n[1]=y[1]*P,n[2]=y[2]*P,n[3]=y[3]*P,n}const ht=At;function rt(y,P,d){const n=d??new f(4);return n[0]=y[0]/P,n[1]=y[1]/P,n[2]=y[2]/P,n[3]=y[3]/P,n}function nt(y,P){return y[0]*P[0]+y[1]*P[1]+y[2]*P[2]+y[3]*P[3]}function Ft(y,P,d,n){const i=n??new f(4);return i[0]=y[0]+d*(P[0]-y[0]),i[1]=y[1]+d*(P[1]-y[1]),i[2]=y[2]+d*(P[2]-y[2]),i[3]=y[3]+d*(P[3]-y[3]),i}function at(y){const P=y[0],d=y[1],n=y[2],i=y[3];return Math.sqrt(P*P+d*d+n*n+i*i)}const mt=at;function et(y){const P=y[0],d=y[1],n=y[2],i=y[3];return P*P+d*d+n*n+i*i}const Z=et;function V(y,P){const d=P??new f(4),n=y[0],i=y[1],o=y[2],u=y[3],w=Math.sqrt(n*n+i*i+o*o+u*u);return w>1e-5?(d[0]=n/w,d[1]=i/w,d[2]=o/w,d[3]=u/w):(d[0]=0,d[1]=0,d[2]=0,d[3]=1),d}function O(y,P){return Math.abs(y[0]-P[0])<R&&Math.abs(y[1]-P[1])<R&&Math.abs(y[2]-P[2])<R&&Math.abs(y[3]-P[3])<R}function ut(y,P){return y[0]===P[0]&&y[1]===P[1]&&y[2]===P[2]&&y[3]===P[3]}function Gt(y){const P=y??new f(4);return P[0]=0,P[1]=0,P[2]=0,P[3]=1,P}const X=x.create(),Rt=x.create(),Bt=x.create();function Lt(y,P,d){const n=d??new f(4),i=x.dot(y,P);return i<-.999999?(x.cross(Rt,y,X),x.len(X)<1e-6&&x.cross(Bt,y,X),x.normalize(X,X),T(X,Math.PI,n),n):i>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(x.cross(y,P,X),n[0]=X[0],n[1]=X[1],n[2]=X[2],n[3]=1+i,V(n,n))}const Tt=new f(4),qt=new f(4);function Vt(y,P,d,n,i,o){const u=o??new f(4);return H(y,n,i,Tt),H(P,d,i,qt),H(Tt,qt,2*i*(1-i),u),u}return{create:m,fromValues:S,set:G,fromAxisAngle:T,toAxisAngle:q,angle:L,multiply:N,mul:W,rotateX:$,rotateY:Q,rotateZ:K,slerp:H,inverse:C,conjugate:J,fromMat:tt,fromEuler:k,copy:b,clone:it,add:lt,subtract:Dt,sub:dt,mulScalar:At,scale:ht,divScalar:rt,dot:nt,lerp:Ft,length:at,len:mt,lengthSq:et,lenSq:Z,normalize:V,equalsApproximately:O,equals:ut,identity:Gt,rotationTo:Lt,sqlerp:Vt}}const cn=new Map;function Dn(f){let x=cn.get(f);return x||(x=Mn(f),cn.set(f,x)),x}function An(f){function x(d,n,i,o){const u=new f(4);return d!==void 0&&(u[0]=d,n!==void 0&&(u[1]=n,i!==void 0&&(u[2]=i,o!==void 0&&(u[3]=o)))),u}const m=x;function S(d,n,i,o,u){const w=u??new f(4);return w[0]=d,w[1]=n,w[2]=i,w[3]=o,w}function G(d,n){const i=n??new f(4);return i[0]=Math.ceil(d[0]),i[1]=Math.ceil(d[1]),i[2]=Math.ceil(d[2]),i[3]=Math.ceil(d[3]),i}function T(d,n){const i=n??new f(4);return i[0]=Math.floor(d[0]),i[1]=Math.floor(d[1]),i[2]=Math.floor(d[2]),i[3]=Math.floor(d[3]),i}function q(d,n){const i=n??new f(4);return i[0]=Math.round(d[0]),i[1]=Math.round(d[1]),i[2]=Math.round(d[2]),i[3]=Math.round(d[3]),i}function L(d,n=0,i=1,o){const u=o??new f(4);return u[0]=Math.min(i,Math.max(n,d[0])),u[1]=Math.min(i,Math.max(n,d[1])),u[2]=Math.min(i,Math.max(n,d[2])),u[3]=Math.min(i,Math.max(n,d[3])),u}function N(d,n,i){const o=i??new f(4);return o[0]=d[0]+n[0],o[1]=d[1]+n[1],o[2]=d[2]+n[2],o[3]=d[3]+n[3],o}function W(d,n,i,o){const u=o??new f(4);return u[0]=d[0]+n[0]*i,u[1]=d[1]+n[1]*i,u[2]=d[2]+n[2]*i,u[3]=d[3]+n[3]*i,u}function $(d,n,i){const o=i??new f(4);return o[0]=d[0]-n[0],o[1]=d[1]-n[1],o[2]=d[2]-n[2],o[3]=d[3]-n[3],o}const Q=$;function K(d,n){return Math.abs(d[0]-n[0])<R&&Math.abs(d[1]-n[1])<R&&Math.abs(d[2]-n[2])<R&&Math.abs(d[3]-n[3])<R}function H(d,n){return d[0]===n[0]&&d[1]===n[1]&&d[2]===n[2]&&d[3]===n[3]}function C(d,n,i,o){const u=o??new f(4);return u[0]=d[0]+i*(n[0]-d[0]),u[1]=d[1]+i*(n[1]-d[1]),u[2]=d[2]+i*(n[2]-d[2]),u[3]=d[3]+i*(n[3]-d[3]),u}function J(d,n,i,o){const u=o??new f(4);return u[0]=d[0]+i[0]*(n[0]-d[0]),u[1]=d[1]+i[1]*(n[1]-d[1]),u[2]=d[2]+i[2]*(n[2]-d[2]),u[3]=d[3]+i[3]*(n[3]-d[3]),u}function tt(d,n,i){const o=i??new f(4);return o[0]=Math.max(d[0],n[0]),o[1]=Math.max(d[1],n[1]),o[2]=Math.max(d[2],n[2]),o[3]=Math.max(d[3],n[3]),o}function k(d,n,i){const o=i??new f(4);return o[0]=Math.min(d[0],n[0]),o[1]=Math.min(d[1],n[1]),o[2]=Math.min(d[2],n[2]),o[3]=Math.min(d[3],n[3]),o}function b(d,n,i){const o=i??new f(4);return o[0]=d[0]*n,o[1]=d[1]*n,o[2]=d[2]*n,o[3]=d[3]*n,o}const it=b;function lt(d,n,i){const o=i??new f(4);return o[0]=d[0]/n,o[1]=d[1]/n,o[2]=d[2]/n,o[3]=d[3]/n,o}function Dt(d,n){const i=n??new f(4);return i[0]=1/d[0],i[1]=1/d[1],i[2]=1/d[2],i[3]=1/d[3],i}const dt=Dt;function At(d,n){return d[0]*n[0]+d[1]*n[1]+d[2]*n[2]+d[3]*n[3]}function ht(d){const n=d[0],i=d[1],o=d[2],u=d[3];return Math.sqrt(n*n+i*i+o*o+u*u)}const rt=ht;function nt(d){const n=d[0],i=d[1],o=d[2],u=d[3];return n*n+i*i+o*o+u*u}const Ft=nt;function at(d,n){const i=d[0]-n[0],o=d[1]-n[1],u=d[2]-n[2],w=d[3]-n[3];return Math.sqrt(i*i+o*o+u*u+w*w)}const mt=at;function et(d,n){const i=d[0]-n[0],o=d[1]-n[1],u=d[2]-n[2],w=d[3]-n[3];return i*i+o*o+u*u+w*w}const Z=et;function V(d,n){const i=n??new f(4),o=d[0],u=d[1],w=d[2],p=d[3],g=Math.sqrt(o*o+u*u+w*w+p*p);return g>1e-5?(i[0]=o/g,i[1]=u/g,i[2]=w/g,i[3]=p/g):(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}function O(d,n){const i=n??new f(4);return i[0]=-d[0],i[1]=-d[1],i[2]=-d[2],i[3]=-d[3],i}function ut(d,n){const i=n??new f(4);return i[0]=d[0],i[1]=d[1],i[2]=d[2],i[3]=d[3],i}const Gt=ut;function X(d,n,i){const o=i??new f(4);return o[0]=d[0]*n[0],o[1]=d[1]*n[1],o[2]=d[2]*n[2],o[3]=d[3]*n[3],o}const Rt=X;function Bt(d,n,i){const o=i??new f(4);return o[0]=d[0]/n[0],o[1]=d[1]/n[1],o[2]=d[2]/n[2],o[3]=d[3]/n[3],o}const Lt=Bt;function Tt(d){const n=d??new f(4);return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n}function qt(d,n,i){const o=i??new f(4),u=d[0],w=d[1],p=d[2],g=d[3];return o[0]=n[0]*u+n[4]*w+n[8]*p+n[12]*g,o[1]=n[1]*u+n[5]*w+n[9]*p+n[13]*g,o[2]=n[2]*u+n[6]*w+n[10]*p+n[14]*g,o[3]=n[3]*u+n[7]*w+n[11]*p+n[15]*g,o}function Vt(d,n,i){const o=i??new f(4);return V(d,o),b(o,n,o)}function y(d,n,i){const o=i??new f(4);return ht(d)>n?Vt(d,n,o):ut(d,o)}function P(d,n,i){const o=i??new f(4);return C(d,n,.5,o)}return{create:x,fromValues:m,set:S,ceil:G,floor:T,round:q,clamp:L,add:N,addScaled:W,subtract:$,sub:Q,equalsApproximately:K,equals:H,lerp:C,lerpV:J,max:tt,min:k,mulScalar:b,scale:it,divScalar:lt,inverse:Dt,invert:dt,dot:At,length:ht,len:rt,lengthSq:nt,lenSq:Ft,distance:at,dist:mt,distanceSq:et,distSq:Z,normalize:V,negate:O,copy:ut,clone:Gt,multiply:X,mul:Rt,divide:Bt,div:Lt,zero:Tt,transformMat4:qt,setLength:Vt,truncate:y,midpoint:P}}const rn=new Map;function mn(f){let x=rn.get(f);return x||(x=An(f),rn.set(f,x)),x}function _t(f,x,m,S,G,T){return{mat3:gn(f),mat4:yn(x),quat:Dn(m),vec2:fn(S),vec3:$t(G),vec4:mn(T)}}const{mat4:_,vec3:Kt}=_t(Float32Array,Float32Array,Float32Array,Float32Array,Float32Array,Float32Array);_t(Float64Array,Float64Array,Float64Array,Float64Array,Float64Array,Float64Array);_t(dn,Array,Array,Array,Array,Array);class Pn{map=new Map;add(x){this.map.set(x.id,x)}get(x){return this.map.get(x)?.resource}list(){return Array.from(this.map.values())}async disposeAll(){for(const x of this.map.values())await x.dispose?.();this.map.clear()}}function Sn(){return new Pn}const zn={async init(f={}){if(!("gpu"in navigator))throw new Error("WebGPU is not available in this environment.");const x=await navigator.gpu.requestAdapter({featureLevel:"compatibility"});if(!x)throw new Error("Unable to acquire a GPU adapter.");try{const m=await x.requestDevice({requiredFeatures:f.requiredFeatures,requiredLimits:f.requiredLimits}),S=m.queue,G=m.limits,T=[];if(f.onError){const L=N=>{f.onError?.(N.error)};m.addEventListener("uncapturederror",L),T.push(()=>m.removeEventListener("uncapturederror",L)),m.lost.then(N=>{f.onError?.(new Error(`Device lost (${N.reason}): ${N.message}`))}).catch(()=>{})}return{adapter:x,device:m,queue:S,limits:G,async configureSurface(L){const N=f.canvas;if(!N)throw new Error("DeviceHost options.canvas is required to configure a surface.");L.configure({device:m,canvas:N,format:f.surfaceConfig?.format,depthFormat:f.surfaceConfig?.depthFormat,sizeProvider:f.surfaceConfig?.sizeProvider})},createResourceRegistry(){return Sn()},async dispose(){for(const L of T.splice(0,T.length))await L();typeof m.destroy=="function"&&m.destroy()}}}catch(m){throw f.onError?.(m instanceof Error?m:new Error("Failed to initialize GPU device.")),m}}};class vn{config;context;depthTexture;currentSize;internalFormat=navigator.gpu.getPreferredCanvasFormat();internalDepthFormat;get format(){return this.internalFormat}get depthFormat(){return this.internalDepthFormat}configure(x){this.config=x,this.context=x.canvas.getContext("webgpu"),this.internalFormat=x.format??navigator.gpu.getPreferredCanvasFormat(),this.internalDepthFormat=x.depthFormat,this.resize()}acquireFrame(){if(!this.config||!this.context||!this.currentSize)throw new Error("Surface not configured.");const x=this.context.getCurrentTexture().createView(),m=this.depthTexture?.createView();return{colorView:x,depthView:m,presentationFormat:this.internalFormat,size:this.currentSize}}resize(){if(!this.config||!this.context)return;const x=window.devicePixelRatio||1,m=this.config.sizeProvider?.(),S=(m?.width??this.config.canvas.clientWidth)*x,G=(m?.height??this.config.canvas.clientHeight)*x;this.config.canvas.width=S,this.config.canvas.height=G,this.context.configure({device:this.config.device,format:this.internalFormat}),this.internalDepthFormat&&(this.depthTexture?.destroy(),this.depthTexture=this.config.device.createTexture({size:[S,G,1],format:this.internalDepthFormat,usage:GPUTextureUsage.RENDER_ATTACHMENT})),this.currentSize={width:S,height:G,devicePixelRatio:x}}dispose(){this.depthTexture?.destroy(),this.depthTexture=void 0,this.context=void 0,this.config=void 0,this.currentSize=void 0}}const Gn=40,Bn=0,Tn=32,Fn=36,an=new Float32Array([1,-1,1,1,1,0,1,1,0,1,-1,-1,1,1,0,0,1,1,1,1,-1,-1,-1,1,0,0,0,1,1,0,1,-1,-1,1,1,0,0,1,0,0,1,-1,1,1,1,0,1,1,0,1,-1,-1,-1,1,0,0,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,-1,1,1,1,0,1,1,1,1,1,-1,-1,1,1,0,0,1,1,0,1,1,-1,1,1,1,0,1,0,0,1,1,1,1,1,1,1,1,0,1,1,-1,-1,1,1,0,0,1,1,0,-1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,1,1,1,0,1,1,0,-1,1,-1,1,0,1,0,1,0,0,-1,1,1,1,0,1,1,1,0,1,1,1,-1,1,1,1,0,1,1,0,-1,-1,1,1,0,0,1,1,0,1,-1,1,1,1,0,1,1,1,1,1,-1,1,-1,1,0,1,0,1,1,0,-1,-1,-1,1,0,0,0,1,0,0,-1,-1,1,1,0,0,1,1,0,1,-1,1,-1,1,0,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,-1,1,1,1,0,1,1,1,1,1,-1,-1,1,1,0,0,1,1,1,0,-1,-1,1,1,0,0,1,1,1,0,1,-1,1,1,1,0,1,1,0,0,1,1,1,1,1,1,1,1,0,1,1,-1,-1,1,1,0,0,1,0,1,-1,-1,-1,1,0,0,0,1,1,1,-1,1,-1,1,0,1,0,1,1,0,1,1,-1,1,1,1,0,1,0,0,1,-1,-1,1,1,0,0,1,0,1,-1,1,-1,1,0,1,0,1,1,0]),En=`// Positions for simple quad geometry\r
const pos = array(vec2f(0, -1), vec2f(1, -1), vec2f(0, 0), vec2f(1, 0));\r
\r
struct VertexInput {\r
  @builtin(vertex_index) vertex : u32,\r
  @builtin(instance_index) instance : u32,\r
};\r
\r
struct VertexOutput {\r
  @builtin(position) position : vec4f,\r
  @location(0) texcoord : vec2f,\r
};\r
\r
struct Char {\r
  texOffset: vec2f,\r
  texExtent: vec2f,\r
  size: vec2f,\r
  offset: vec2f,\r
};\r
\r
struct FormattedText {\r
  transform: mat4x4f,\r
  color: vec4f,\r
  scale: f32,\r
  chars: array<vec3f>,\r
};\r
\r
struct Camera {\r
  projection: mat4x4f,\r
  view: mat4x4f,\r
};\r
\r
// Font bindings\r
@group(0) @binding(0) var fontTexture: texture_2d<f32>;\r
@group(0) @binding(1) var fontSampler: sampler;\r
@group(0) @binding(2) var<storage> chars: array<Char>;\r
\r
// Text bindings\r
@group(1) @binding(0) var<uniform> camera: Camera;\r
@group(1) @binding(1) var<storage> text: FormattedText;\r
\r
@vertex\r
fn vertexMain(input : VertexInput) -> VertexOutput {\r
  let textElement = text.chars[input.instance];\r
  let char = chars[u32(textElement.z)];\r
  let charPos = (pos[input.vertex] * char.size + textElement.xy + char.offset) * text.scale;\r
\r
  var output : VertexOutput;\r
  output.position = camera.projection * camera.view * text.transform * vec4f(charPos, 0, 1);\r
\r
  output.texcoord = pos[input.vertex] * vec2f(1, -1);\r
  output.texcoord *= char.texExtent;\r
  output.texcoord += char.texOffset;\r
  return output;\r
}\r
\r
fn sampleMsdf(texcoord: vec2f) -> f32 {\r
  let c = textureSample(fontTexture, fontSampler, texcoord);\r
  return max(min(c.r, c.g), min(max(c.r, c.g), c.b));\r
}\r
\r
// Antialiasing technique from Paul Houx \r
// https://github.com/Chlumsky/msdfgen/issues/22#issuecomment-234958005\r
@fragment\r
fn fragmentMain(input : VertexOutput) -> @location(0) vec4f {\r
  // pxRange (AKA distanceRange) comes from the msdfgen tool. Don McCurdy's tool\r
  // uses the default which is 4.\r
  let pxRange = 4.0;\r
  let sz = vec2f(textureDimensions(fontTexture, 0));\r
  let dx = sz.x*length(vec2f(dpdxFine(input.texcoord.x), dpdyFine(input.texcoord.x)));\r
  let dy = sz.y*length(vec2f(dpdxFine(input.texcoord.y), dpdyFine(input.texcoord.y)));\r
  let toPixels = pxRange * inverseSqrt(dx * dx + dy * dy);\r
  let sigDist = sampleMsdf(input.texcoord) - 0.5;\r
  let pxDist = sigDist * toPixels;\r
\r
  let edgeWidth = 0.5;\r
\r
  let alpha = smoothstep(-edgeWidth, edgeWidth, pxDist);\r
\r
  if (alpha < 0.001) {\r
    discard;\r
  }\r
\r
  return vec4f(text.color.rgb, text.color.a * alpha);\r
}`;class Un{constructor(x,m,S,G,T){this.pipeline=x,this.bindGroup=m,this.lineHeight=S,this.chars=G,this.kernings=T;const q=Object.values(G);this.charCount=q.length,this.defaultChar=q[0]}charCount;defaultChar;getChar(x){let m=this.chars[x];return m||(m=this.defaultChar),m}getXAdvance(x,m=-1){const S=this.getChar(x);if(m>=0){const G=this.kernings.get(x);if(G)return S.xadvance+(G.get(m)??0)}return S.xadvance}}class In{constructor(x,m,S,G,T){this.device=x,this.renderBundle=m,this.measurements=S,this.font=G,this.textBuffer=T,_.identity(this.bufferArray),this.setColor(1,1,1,1),this.setPixelScale(1/512),this.bufferArrayDirty=!0}bufferArray=new Float32Array(24);bufferArrayDirty=!0;getRenderBundle(){return this.bufferArrayDirty&&(this.bufferArrayDirty=!1,this.device.queue.writeBuffer(this.textBuffer,0,this.bufferArray.buffer,this.bufferArray.byteOffset,this.bufferArray.byteLength)),this.renderBundle}setTransform(x){_.copy(x,this.bufferArray),this.bufferArrayDirty=!0}setColor(x,m,S,G=1){this.bufferArray[16]=x,this.bufferArray[17]=m,this.bufferArray[18]=S,this.bufferArray[19]=G,this.bufferArrayDirty=!0}setPixelScale(x){this.bufferArray[20]=x,this.bufferArrayDirty=!0}}class qn{constructor(x,m,S){this.device=x,this.renderBundleDescriptor={colorFormats:[m],depthStencilFormat:S},this.sampler=x.createSampler({label:"MSDF text sampler",minFilter:"linear",magFilter:"linear",mipmapFilter:"linear",maxAnisotropy:16}),this.cameraUniformBuffer=x.createBuffer({label:"MSDF camera uniform buffer",size:this.cameraArray.byteLength,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM}),this.fontBindGroupLayout=x.createBindGroupLayout({label:"MSDF font group layout",entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,texture:{}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{}},{binding:2,visibility:GPUShaderStage.VERTEX,buffer:{type:"read-only-storage"}}]}),this.textBindGroupLayout=x.createBindGroupLayout({label:"MSDF text group layout",entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{}},{binding:1,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{type:"read-only-storage"}}]});const G=x.createShaderModule({label:"MSDF text shader",code:En});this.pipelinePromise=x.createRenderPipelineAsync({label:"msdf text pipeline",layout:x.createPipelineLayout({bindGroupLayouts:[this.fontBindGroupLayout,this.textBindGroupLayout]}),vertex:{module:G,entryPoint:"vertexMain"},fragment:{module:G,entryPoint:"fragmentMain",targets:[{format:m,blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one"}}}]},primitive:{topology:"triangle-strip",stripIndexFormat:"uint32"},depthStencil:{depthWriteEnabled:!1,depthCompare:"less",format:S}})}fontBindGroupLayout;textBindGroupLayout;pipelinePromise;sampler;cameraUniformBuffer;renderBundleDescriptor;cameraArray=new Float32Array(32);async loadTexture(x){const m=await fetch(x),S=await createImageBitmap(await m.blob()),G=this.device.createTexture({label:`MSDF font texture ${x}`,size:[S.width,S.height,1],format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT});return this.device.queue.copyExternalImageToTexture({source:S},{texture:G},[S.width,S.height]),G}async createFont(x){const S=await(await fetch(x)).json(),G=x.lastIndexOf("/"),T=G!==-1?x.substring(0,G+1):void 0,q=[];for(const k of S.pages)q.push(this.loadTexture(T+k));const L=S.chars.length,N=this.device.createBuffer({label:"MSDF character layout buffer",size:L*Float32Array.BYTES_PER_ELEMENT*8,usage:GPUBufferUsage.STORAGE,mappedAtCreation:!0}),W=new Float32Array(N.getMappedRange()),$=1/S.common.scaleW,Q=1/S.common.scaleH,K={};let H=0;for(const[k,b]of S.chars.entries())K[b.id]=b,K[b.id].charIndex=k,W[H]=b.x*$,W[H+1]=b.y*Q,W[H+2]=b.width*$,W[H+3]=b.height*Q,W[H+4]=b.width,W[H+5]=b.height,W[H+6]=b.xoffset,W[H+7]=-b.yoffset,H+=8;N.unmap();const C=await Promise.all(q),J=this.device.createBindGroup({label:"msdf font bind group",layout:this.fontBindGroupLayout,entries:[{binding:0,resource:C[0].createView()},{binding:1,resource:this.sampler},{binding:2,resource:{buffer:N}}]}),tt=new Map;if(S.kernings)for(const k of S.kernings){let b=tt.get(k.first);b||(b=new Map,tt.set(k.first,b)),b.set(k.second,k.amount)}return new Un(await this.pipelinePromise,J,S.common.lineHeight,K,tt)}formatText(x,m,S={}){const G=this.device.createBuffer({label:"msdf text buffer",size:(m.length+6)*Float32Array.BYTES_PER_ELEMENT*4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,mappedAtCreation:!0}),T=new Float32Array(G.getMappedRange());let q=24,L;S.centered?(L=this.measureText(x,m),this.measureText(x,m,(K,H,C,J)=>{const tt=L.width*-.5-(L.width-L.lineWidths[C])*-.5;T[q]=K+tt,T[q+1]=H+L.height*.5,T[q+2]=J.charIndex,q+=4})):L=this.measureText(x,m,(K,H,C,J)=>{T[q]=K,T[q+1]=H,T[q+2]=J.charIndex,q+=4}),G.unmap();const N=this.device.createBindGroup({label:"msdf text bind group",layout:this.textBindGroupLayout,entries:[{binding:0,resource:{buffer:this.cameraUniformBuffer}},{binding:1,resource:{buffer:G}}]}),W=this.device.createRenderBundleEncoder(this.renderBundleDescriptor);W.setPipeline(x.pipeline),W.setBindGroup(0,x.bindGroup),W.setBindGroup(1,N),W.draw(4,L.printedCharCount);const $=W.finish(),Q=new In(this.device,$,L,x,G);return S.pixelScale!==void 0&&Q.setPixelScale(S.pixelScale),S.color!==void 0&&Q.setColor(...S.color),Q}measureText(x,m,S){let G=0;const T=[];let q=0,L=0,N=0,W=0,$=m.charCodeAt(0);for(let Q=0;Q<m.length;++Q){const K=$;switch($=Q<m.length-1?m.charCodeAt(Q+1):-1,K){case 10:T.push(q),N++,G=Math.max(G,q),q=0,L-=x.lineHeight;case 13:break;case 32:q+=x.getXAdvance(K);break;default:S&&S(q,L,N,x.getChar(K)),q+=x.getXAdvance(K,$),W++}}return T.push(q),G=Math.max(G,q),{width:G,height:T.length*x.lineHeight,lineWidths:T,printedCharCount:W}}updateCamera(x,m){this.cameraArray.set(x,0),this.cameraArray.set(m,16),this.device.queue.writeBuffer(this.cameraUniformBuffer,0,this.cameraArray.buffer,0,this.cameraArray.byteLength)}render(x,...m){const S=m.map(G=>G.getRenderBundle());x.executeBundles(S)}}globalThis.addEventListener("unhandledrejection",f=>{Wt(`unhandled promise rejection, please report a bug!
  https://github.com/webgpu/webgpu-samples/issues/new
${f.reason}`)});globalThis.addEventListener("error",f=>{Wt(`uncaught exception, please report a bug!
  https://github.com/webgpu/webgpu-samples/issues/new
${f.error}`)});function Vn(f){"gpu"in navigator||Wt("navigator.gpu is not defined - WebGPU not available in this browser"),f||Wt("requestAdapter returned null - this sample can't run on this system")}function Rn(f,x){if(!x){Vn(f),Wt("Unable to get a device for an unknown reason");return}x.lost.then(m=>{Wt(`Device lost ("${m.reason}"):
${m.message}`)}),x.addEventListener("uncapturederror",m=>{Wt(`Uncaptured error:
${m.error.message}`)})}const Wt=(()=>{function f(){if(typeof document>"u")return{show(T){console.error(T)}};const m=document.createElement("dialog");m.close(),document.body.append(m);const S=document.createElement("pre");S.style.whiteSpace="pre-wrap",m.append(S);const G=document.createElement("button");return G.textContent="OK",G.onclick=()=>m.close(),m.append(G),{show(T){m.open||(S.textContent=T,m.showModal())}}}let x;return m=>{throw x||(x=f()),x.show(m),new Error(m)}})();let jt;async function Ln(){jt&&(await jt(),jt=void 0);const f=[],x=document.getElementById("gfx");if(!x)throw new Error('Canvas element with id "gfx" was not found.');const m=await zn.init({canvas:x,requiredLimits:{maxStorageBuffersInFragmentStage:1,maxStorageBuffersInVertexStage:2},onError:V=>console.error("[mini-gfx] WebGPU error:",V),surfaceConfig:{depthFormat:"depth24plus"}});Rn(m.adapter,m.device);const S=new vn;await m.configureSurface(S);const G=()=>S.resize();window.addEventListener("resize",G),f.push(()=>window.removeEventListener("resize",G));const T=m.device,q=m.queue,L=S.format,N=S.depthFormat??"depth24plus",W=new qn(T,L,N),$=await W.createFont(new URL("/assets/ya-hei-ascii-msdf-BNsUZnRi.json",import.meta.url).toString()),Q=Wn(W,$),K=W.formatText($,"WebGPU",{centered:!0,pixelScale:1/128}),H=bn(W,$),C=[...Q,K,H],J=await un(new URL("data:text/wgsl;base64,c3RydWN0IFVuaWZvcm1zIHsNCiAgbW9kZWxWaWV3UHJvamVjdGlvbk1hdHJpeCA6IG1hdDR4NGYsDQp9DQpAYmluZGluZygwKSBAZ3JvdXAoMCkgdmFyPHVuaWZvcm0+IHVuaWZvcm1zIDogVW5pZm9ybXM7DQoNCnN0cnVjdCBWZXJ0ZXhPdXRwdXQgew0KICBAYnVpbHRpbihwb3NpdGlvbikgUG9zaXRpb24gOiB2ZWM0ZiwNCiAgQGxvY2F0aW9uKDApIGZyYWdVViA6IHZlYzJmLA0KICBAbG9jYXRpb24oMSkgZnJhZ1Bvc2l0aW9uOiB2ZWM0ZiwNCn0NCg0KQHZlcnRleA0KZm4gbWFpbigNCiAgQGxvY2F0aW9uKDApIHBvc2l0aW9uIDogdmVjNGYsDQogIEBsb2NhdGlvbigxKSB1diA6IHZlYzJmDQopIC0+IFZlcnRleE91dHB1dCB7DQogIHZhciBvdXRwdXQgOiBWZXJ0ZXhPdXRwdXQ7DQogIG91dHB1dC5Qb3NpdGlvbiA9IHVuaWZvcm1zLm1vZGVsVmlld1Byb2plY3Rpb25NYXRyaXggKiBwb3NpdGlvbjsNCiAgb3V0cHV0LmZyYWdVViA9IHV2Ow0KICBvdXRwdXQuZnJhZ1Bvc2l0aW9uID0gMC41ICogKHBvc2l0aW9uICsgdmVjNCgxLjAsIDEuMCwgMS4wLCAxLjApKTsNCiAgcmV0dXJuIG91dHB1dDsNCn0NCg==",import.meta.url)),tt=await un(new URL("data:text/wgsl;base64,QGZyYWdtZW50DQpmbiBtYWluKA0KICBAbG9jYXRpb24oMCkgZnJhZ1VWOiB2ZWMyZiwNCiAgQGxvY2F0aW9uKDEpIGZyYWdQb3NpdGlvbjogdmVjNGYNCikgLT4gQGxvY2F0aW9uKDApIHZlYzRmIHsNCiAgcmV0dXJuIGZyYWdQb3NpdGlvbjsNCn0NCg==",import.meta.url)),k=T.createRenderPipeline({layout:"auto",vertex:{module:T.createShaderModule({code:J}),buffers:[{arrayStride:Gn,attributes:[{shaderLocation:0,offset:Bn,format:"float32x4"},{shaderLocation:1,offset:Tn,format:"float32x2"}]}]},fragment:{module:T.createShaderModule({code:tt}),targets:[{format:L}]},primitive:{topology:"triangle-list",cullMode:"back"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:N}}),b=T.createBuffer({size:an.byteLength,usage:GPUBufferUsage.VERTEX,mappedAtCreation:!0});new Float32Array(b.getMappedRange()).set(an),b.unmap();const lt=T.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),Dt=T.createBindGroup({layout:k.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:lt}}]}),dt=_.create(),At=_.create(),ht=_.create(),rt=_.create(),nt=_.create(),Ft=[bt([0,0,1.1]),bt([0,0,-1.1],[0,Math.PI,0]),bt([1.1,0,0],[0,Math.PI/2,0]),bt([-1.1,0,0],[0,-Math.PI/2,0]),bt([0,1.1,0],[-Math.PI/2,0,0]),bt([0,-1.1,0],[Math.PI/2,0,0])],at=performance.now();let mt=0;const et=()=>{mt=requestAnimationFrame(et);const V=S.acquireFrame();Zn(V,dt,At,ht,rt),q.writeBuffer(lt,0,rt.buffer,rt.byteOffset,rt.byteLength),On(Ft,Q,ht,nt),Nn(K,H,at,nt),W.updateCamera(dt,At);const O={view:V.colorView,clearValue:[0,0,0,1],loadOp:"clear",storeOp:"store"},ut=V.depthView?{view:V.depthView,depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store"}:void 0,Gt=T.createCommandEncoder(),X=Gt.beginRenderPass({colorAttachments:[O],depthStencilAttachment:ut});X.setPipeline(k),X.setBindGroup(0,Dt),X.setVertexBuffer(0,b),X.draw(Fn,1,0,0),W.render(X,...C),X.end(),q.submit([Gt.finish()])};mt=requestAnimationFrame(et),f.push(()=>cancelAnimationFrame(mt));const Z=async()=>{b.destroy(),lt.destroy(),C.forEach(V=>V.textBuffer.destroy()),S.dispose(),await m.dispose()};window.addEventListener("beforeunload",Z),f.push(()=>window.removeEventListener("beforeunload",Z)),f.push(()=>void Z()),jt=async()=>{for(const V of f.splice(0))await V()}}function Wn(f,x){return[f.formatText(x,"Front",{centered:!0,pixelScale:1/128,color:[1,0,0,1]}),f.formatText(x,"Back",{centered:!0,pixelScale:1/128,color:[0,1,1,1]}),f.formatText(x,"Right",{centered:!0,pixelScale:1/128,color:[0,1,0,1]}),f.formatText(x,"Left",{centered:!0,pixelScale:1/128,color:[1,0,1,1]}),f.formatText(x,"Top",{centered:!0,pixelScale:1/128,color:[0,0,1,1]}),f.formatText(x,"Bottom",{centered:!0,pixelScale:1/128,color:[1,1,0,1]})]}function bn(f,x){return f.formatText(x,`WebGPU exposes an API for performing operations, such as rendering and computation, on a Graphics Processing Unit.

Graphics Processing Units, or GPUs for short, have been essential in enabling rich rendering and computational applications in personal computing. WebGPU is an API that exposes the capabilities of GPU hardware for the Web. The API is designed from the ground up to efficiently map to (post-2014) native GPU APIs. WebGPU is not related to WebGL and does not explicitly target OpenGL ES.

WebGPU sees physical GPU hardware as GPUAdapters. It provides a connection to an adapter via GPUDevice, which manages resources, and the device's GPUQueues, which execute commands. GPUDevice may have its own memory with high-speed access to the processing units. GPUBuffer and GPUTexture are the physical resources backed by GPU memory. GPUCommandBuffer and GPURenderBundle are containers for user-recorded commands. GPUShaderModule contains shader code. The other resources, such as GPUSampler or GPUBindGroup, configure the way physical resources are used by the GPU.

GPUs execute commands encoded in GPUCommandBuffers by feeding data through a pipeline, which is a mix of fixed-function and programmable stages. Programmable stages execute shaders, which are special programs designed to run on GPU hardware. Most of the state of a pipeline is defined by a GPURenderPipeline or a GPUComputePipeline object. The state not included in these pipeline objects is set during encoding with commands, such as beginRenderPass() or setBlendConstant().`,{pixelScale:1/256})}function Zn(f,x,m,S,G){const T=f.size.width/f.size.height,q=_.perspective(2*Math.PI/5,T,1,100);x.set(q),_.identity(m),_.translate(m,Kt.fromValues(0,0,-5),m);const L=performance.now()/5e3;_.identity(S),_.translate(S,Kt.fromValues(0,2,-3),S),_.rotate(S,Kt.fromValues(Math.sin(L),Math.cos(L),0),1,S),_.multiply(x,m,G),_.multiply(G,S,G)}function On(f,x,m,S){f.forEach((G,T)=>{_.multiply(m,G,S),x[T].setTransform(S)})}function Nn(f,x,m,S){const G=(performance.now()-m)/2500%14;_.identity(S),_.rotateX(S,-Math.PI/8,S),_.translate(S,[0,G-3,0],S),f.setTransform(S),_.translate(S,[-3,-.1,0],S),x.setTransform(S)}function bt(f,x){const m=_.identity(_.create());return _.translate(m,f,m),x&&(x[0]&&_.rotateX(m,x[0],m),x[1]&&_.rotateY(m,x[1],m),x[2]&&_.rotateZ(m,x[2],m)),m}async function un(f){const x=await fetch(f.toString());if(!x.ok)throw new Error(`Failed to load shader at ${f.href}`);return x.text()}Ln().catch(f=>{console.error("[mini-gfx] initialization failed:",f)});
